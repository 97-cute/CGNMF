Overview of CGNMF

CGNMF integrates spatial graph regularization and contrastive learning to enhance feature representation while preserving biological and spatial coherence. 
The pipeline begins with preprocessing of the gene expression count matrix alongside spatial positional information of tissue spots. Following this step, the high-dimensional gene expression matrix is factorized into two low-dimensional, non-negative matrices representing latent features and spot-specific weights, respectively . To incorporate spatial context, an adjacency matrix is constructed by leveraging the spatial coordinates of each spot, thereby enforcing local smoothness constraints. This graph structure ensures that spatially adjacent spots in the reduced-dimensional space retain similar expression patterns. To further enhance the discriminative power of the learned representations, CGNMF integrates a self-supervised contrastive learning strategy. Positive and negative sample pairs are generated based on the intersection of nearest and farthest neighbors in both the gene expression and spatial domains. This dual-space neighborhood criterion improves the relevance of positive pairs and the distinctiveness of negative pairs, thereby encouraging the model to minimize distances between similar spots and maximize distances between dissimilar ones in the latent space . Finally, a unified loss function is formulated by combining the reconstruction objective of graph-regularized non-negative matrix factorization with a contrastive loss term. This joint optimization yields a biologically meaningful and spatially consistent low-dimensional representation of the tissue section. The resulting latent features can be readily applied to a range of downstream analyses in spatial transcriptomics, including spatial domain identification, inference of cellâ€“cell interactions, dimensionality reduction via UMAP, and trajectory analysis using partition-based graph abstraction (PAGA), among other applications.
